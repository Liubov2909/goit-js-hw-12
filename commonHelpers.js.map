{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst galleryBox = document.querySelector('.gallery-box');\nconst loaderTopBtn = document.querySelector('.loader-top');\nconst loaderBottomBtn = document.querySelector('.loader-bottom');\nconst input = document.querySelector('input');\nconst loadImg = document.querySelector('.load-image');\nconst body = document.querySelector('body');\n\nlet page = 1;\nlet q = '';\nlet per_page = 40;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captionsData: 'alt',\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nform.addEventListener('submit', onSubmit);\nloadImg.addEventListener('click', loadMore);\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  loaderTopBtn.style.display = 'block';\n  loadImg.style.display = 'none';\n  page = 1;\n  q = event.target.elements.search.value.trim();\n\n  if (!q) {\n    gallery.innerHTML = '';\n    iziToast.info({\n      position: 'topRight',\n      message: 'Error enter any symbols',\n    });\n    loaderTopBtn.style.display = 'none';\n    return;\n  }\n\n  try {\n    const {\n      data: { hits, totalHits },\n    } = await searchImg(q, page);\n\n    if (hits.length > 0) {\n      loaderTopBtn.style.display = 'none';\n      gallery.insertAdjacentHTML('beforeend', renderImg(hits));\n      lightbox.refresh();\n      iziToast.success({\n        position: 'topRight',\n        message: `We found ${totalHits} photos`,\n      });\n      loadImg.style.display = 'block';\n    } else {\n      gallery.innerHTML = '';\n      iziToast.error({\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    if (totalHits <= per_page) {\n      loadImg.style.display = 'none';\n    }\n  } catch (error) {\n    console.log('Error', error);\n  } finally {\n    loaderTopBtn.style.display = 'none';\n    event.target.reset();\n  }\n}\n\nfunction searchImg(q, page) {\n  axios.defaults.baseURL = 'https://pixabay.com';\n\n  return axios.get('/api/', {\n    params: {\n      key: '41529899-34462864becb6db8698a10d1b',\n      q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  });\n}\n\nfunction renderImg(hits = []) {\n  return hits.reduce((html, hit) => {\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=${hit.largeImageURL}>\n          <img class=\"gallery-img\" src=${hit.webformatURL} alt=${hit.tags} />\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${hit.likes}</span></p>\n          <p>views: <span class=\"text-value\">${hit.views}</span></p>\n          <p>comments: <span class=\"text-value\">${hit.comments}</span></p>\n          <p>downloads: <span class=\"text-value\">${hit.downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n}\n\nasync function loadMore(event) {\n  loaderBottomBtn.style.display = 'block';\n  loadImg.style.display = 'none';\n  const listItem = document.querySelector('.gallery-item:first-child');\n\n  if (listItem) {\n    const itemHeight = listItem.getBoundingClientRect().height;\n\n    try {\n      page += 1;\n\n      const {\n        data: { hits, totalHits },\n      } = await searchImg(q, page);\n      const totalPage = Math.ceil(totalHits / per_page);\n\n      loadImg.style.display = 'block';\n      gallery.insertAdjacentHTML('beforeend', renderImg(hits));\n      lightbox.refresh();\n\n      if (page === totalPage) {\n        loadImg.style.display = 'none';\n        return iziToast.info({\n          position: 'topRight',\n          message: `We're sorry, but you've reached the end of search results.`,\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      loaderBottomBtn.style.display = 'none';\n      window.scrollBy({\n        top: 2 * itemHeight,\n        behavior: 'smooth',\n      });\n    }\n  }\n}\n\n// Додано прослуховування події прокрутки сторінки\nwindow.addEventListener('scroll', onScroll);\nconst onScroll = () => {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n"],"names":["form","gallery","loaderTopBtn","loaderBottomBtn","loadImg","page","q","per_page","lightbox","SimpleLightbox","onSubmit","loadMore","event","iziToast","hits","totalHits","searchImg","renderImg","error","axios","html","hit","listItem","itemHeight","totalPage","onScroll","cardHeight"],"mappings":"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"}